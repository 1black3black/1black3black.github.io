{"posts":[{"title":"LeetGPU Problem 1: Vector Addition","text":"Starting with this post, I will be irregularly updating solutions for LeetGPU problems. My goal is to aim for a top-three spot on the performance leaderboard, with the NVIDIA H100 as the benchmark for testing performance. Problem link: Vector Addition The simplest question, calculate the sum of two vectors. Mapping threads one-to-one with data and performing direct summation is an intuitive choice, but using vectorized reads can further improve memory access speed. Solution123456789101112131415161718192021222324252627282930313233343536373839#include &quot;solve.h&quot;#include &lt;cuda_runtime.h&gt;template&lt;size_t BLOCK_TILE_SIZE, size_t THREAD_TILE_SIZE, typename VECTOR_TYPE&gt;__global__ void vector_add(const float* A, const float* B, float* C, int N) { size_t const thread_idx{blockIdx.x * (BLOCK_TILE_SIZE / THREAD_TILE_SIZE) + threadIdx.x}; size_t const res = N % BLOCK_TILE_SIZE; if(thread_idx*THREAD_TILE_SIZE + THREAD_TILE_SIZE - 1U &lt; N){ VECTOR_TYPE A_temp = reinterpret_cast&lt;const VECTOR_TYPE*&gt;(A)[thread_idx]; VECTOR_TYPE B_temp = reinterpret_cast&lt;const VECTOR_TYPE*&gt;(B)[thread_idx]; VECTOR_TYPE C_temp; C_temp.x = A_temp.x + B_temp.x; C_temp.y = A_temp.y + B_temp.y; C_temp.z = A_temp.z + B_temp.z; C_temp.w = A_temp.w + B_temp.w; reinterpret_cast&lt;VECTOR_TYPE*&gt;(C)[thread_idx] = C_temp; }else{#pragma unroll for(int i = 0; i &lt; THREAD_TILE_SIZE; i++){ if(thread_idx*THREAD_TILE_SIZE + i &lt; N){ C[thread_idx*THREAD_TILE_SIZE + i] = A[thread_idx*THREAD_TILE_SIZE + i] + B[thread_idx*THREAD_TILE_SIZE + i]; } } }}// A, B, C are device pointers (i.e. pointers to memory on the GPU)void solve(const float* A, const float* B, float* C, int N) { using VECTOR_TYPE = float4; constexpr unsigned int BLOCK_TILE_SIZE = 4096U; constexpr unsigned int THREAD_TILE_SIZE = 4U; dim3 const grid_dim{(static_cast&lt;unsigned int&gt;(N) + BLOCK_TILE_SIZE - 1U) / BLOCK_TILE_SIZE, 1U, 1U}; dim3 const block_dim{BLOCK_TILE_SIZE / THREAD_TILE_SIZE, 1U, 1U}; vector_add&lt;BLOCK_TILE_SIZE, THREAD_TILE_SIZE, VECTOR_TYPE&gt;&lt;&lt;&lt;grid_dim, block_dim&gt;&gt;&gt;(A, B, C, N); cudaDeviceSynchronize();}","link":"/blog/LeetGPUprob1/"}],"tags":[{"name":"CUDA","slug":"CUDA","link":"/tags/CUDA/"},{"name":"C++","slug":"C","link":"/tags/C/"}],"categories":[{"name":"solution","slug":"solution","link":"/categories/solution/"}],"pages":[{"title":"","text":"","link":"/blog/index.html"},{"title":"个人简介","text":"关于我懒癌复发了，摸完再写","link":"/about/index.html"}]}